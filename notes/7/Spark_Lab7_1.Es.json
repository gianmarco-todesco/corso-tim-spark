{"paragraphs":[{"text":"import org.graphframes._\nval vertices = Seq(\n    (0, \"A\"),\n    (1, \"B\"),\n    (2, \"C\"),\n    (3, \"D\"),\n    (4, \"E\"),\n    (5, \"F\"),\n    (6, \"G\"),\n    (7, \"H\")\n    ).toDF(\"id\", \"name\")\nval edges = Seq(\n    (0,1,10.0),\n    (0,2,10.0),\n    (0,3,10.0),\n    (0,5,20.0),\n    (1,2,10.0),\n    (2,3,10.0),\n    (3,4,10.0),\n    (4,5,10.0),\n    (5,3,10.0),\n    (6,7,20.0),\n    (7,6,20.0)\n    ).toDF(\"src\",\"dst\",\"weight\")\n\nval g = GraphFrame(vertices, edges)\n","user":"admin","dateUpdated":"2019-04-12T01:48:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.graphframes._\nvertices: org.apache.spark.sql.DataFrame = [id: int, name: string]\nedges: org.apache.spark.sql.DataFrame = [src: int, dst: int ... 1 more field]\ng: org.graphframes.GraphFrame = GraphFrame(v:[id: int, name: string], e:[src: int, dst: int ... 1 more field])\n"}]},"apps":[],"jobName":"paragraph_1555028447062_-1602438915","id":"20190412-002047_1687566608","dateCreated":"2019-04-12T00:20:47+0000","dateStarted":"2019-04-12T01:48:38+0000","dateFinished":"2019-04-12T01:48:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:184"},{"text":"println(\"Numero vertici = \" + g.vertices.count)\nprintln(\"Numero archi = \" + g.edges.count)\n","user":"admin","dateUpdated":"2019-04-12T01:51:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Numero vertici = 8\nNumero archi = 11\n"}]},"apps":[],"jobName":"paragraph_1555030923494_915818867","id":"20190412-010203_172121124","dateCreated":"2019-04-12T01:02:03+0000","dateStarted":"2019-04-12T01:51:45+0000","dateFinished":"2019-04-12T01:51:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:185","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.0.97:4040/jobs/job?id=64","http://172.30.0.97:4040/jobs/job?id=65"],"interpreterSettingId":"spark"}}},{"user":"admin","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":true,"title":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555034478108_738623236","id":"20190412-020118_242204743","dateCreated":"2019-04-12T02:01:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9955","text":"def showGraph(g:GraphFrame) = {\r\n    import org.apache.spark.sql.Row\r\n    val nodeOutput = g.vertices.map {\r\n        case Row(id: Int, name: String) => {\r\n\t\t    \"\"\" { \"id\": \"\"\" + id + \"\"\" , \"label\" : \"normal\", \"data\" : { \"name\" : \"\"\"\" + name + \"\"\"\" } } \"\"\"\r\n       }\r\n    }.collect()\r\n    val nodes = nodeOutput.mkString(\"[\", \",\" , \"]\")\r\n\r\n    val edgeOutput = g.edges\r\n        .withColumn(\"id\", monotonically_increasing_id)\r\n        .map {\r\n        case Row(src: Int, dst: Int, weight:Double, id:Long) => {\r\n\t\t    \"\"\" { \"id\": \"\"\" + id + \"\"\", \"source\": \"\"\" + src + \"\"\", \"target\": \"\"\"+ dst +\"\"\" } \"\"\"\r\n        }\r\n    }.collect()\r\n    val edges = edgeOutput.mkString(\"[\", \",\" , \"]\" )\r\n    print(s\"\"\"%network {\r\n        \"nodes\": $nodes,\r\n        \"edges\": $edges2,\r\n        \"labels\" : { \"normal\" : \"#88AAFF\" },\r\n        \"directed\" : true\r\n    }\"\"\")\r\n}\r\n","dateUpdated":"2019-04-12T02:03:48+0000","dateFinished":"2019-04-12T02:03:40+0000","dateStarted":"2019-04-12T02:03:40+0000","title":"","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"showGraph: (g: org.graphframes.GraphFrame)Unit\n"}]}},{"user":"admin","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"network","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","label":"string","name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"network":{"properties":{"normal":{"selected":"name","keys":["name","id","label"]}},"d3Graph":{"forceLayout":{"timeout":10000,"charge":-120,"linkDistance":80},"zoom":{"minScale":1.3}}}},"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555034545079_-1958019929","id":"20190412-020225_831689524","dateCreated":"2019-04-12T02:02:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10087","text":"showGraph(g)","dateUpdated":"2019-04-12T02:03:59+0000","dateFinished":"2019-04-12T02:03:43+0000","dateStarted":"2019-04-12T02:03:42+0000","results":{"code":"SUCCESS","msg":[{"type":"NETWORK","data":"{\n        \"nodes\": [ { \"id\": 0 , \"label\" : \"normal\", \"data\" : { \"name\" : \"A\" } } , { \"id\": 1 , \"label\" : \"normal\", \"data\" : { \"name\" : \"B\" } } , { \"id\": 2 , \"label\" : \"normal\", \"data\" : { \"name\" : \"C\" } } , { \"id\": 3 , \"label\" : \"normal\", \"data\" : { \"name\" : \"D\" } } , { \"id\": 4 , \"label\" : \"normal\", \"data\" : { \"name\" : \"E\" } } , { \"id\": 5 , \"label\" : \"normal\", \"data\" : { \"name\" : \"F\" } } , { \"id\": 6 , \"label\" : \"normal\", \"data\" : { \"name\" : \"G\" } } , { \"id\": 7 , \"label\" : \"normal\", \"data\" : { \"name\" : \"H\" } } ],\n        \"edges\": [ { \"id\": 0, \"source\": 0, \"target\": 1 } , { \"id\": 1, \"source\": 0, \"target\": 2 } , { \"id\": 2, \"source\": 0, \"target\": 3 } , { \"id\": 3, \"source\": 0, \"target\": 5 } , { \"id\": 4, \"source\": 1, \"target\": 2 } , { \"id\": 5, \"source\": 2, \"target\": 3 } , { \"id\": 6, \"source\": 3, \"target\": 4 } , { \"id\": 7, \"source\": 4, \"target\": 5 } , { \"id\": 8, \"source\": 5, \"target\": 3 } , { \"id\": 9, \"source\": 6, \"target\": 7 } , { \"id\": 10, \"source\": 7, \"target\": 6 } ],\n        \"labels\" : { \"normal\" : \"#88AAFF\" },\n        \"directed\" : true\n    }"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.0.97:4040/jobs/job?id=78","http://172.30.0.97:4040/jobs/job?id=79"],"interpreterSettingId":"spark"}}},{"user":"admin","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555033908392_1239215607","id":"20190412-015148_339275201","dateCreated":"2019-04-12T01:51:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9636","text":"g.degrees.join(g.vertices, \"id\").orderBy(desc(\"degree\")).show()","dateUpdated":"2019-04-12T02:05:35+0000","dateFinished":"2019-04-12T02:00:37+0000","dateStarted":"2019-04-12T02:00:33+0000","title":"I nodi ordinati secondo il numero di connessioni","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+------+----+\n| id|degree|name|\n+---+------+----+\n|  0|     4|   A|\n|  3|     4|   D|\n|  5|     3|   F|\n|  2|     3|   C|\n|  1|     2|   B|\n|  4|     2|   E|\n|  6|     2|   G|\n|  7|     2|   H|\n+---+------+----+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.0.97:4040/jobs/job?id=75"],"interpreterSettingId":"spark"}}},{"text":"g.find(\"(a)-[ab]->(b); (b)-[bc]->(c); (c)-[ca]->(a)\")\n    .where(\"a.id < b.id\")\n    .where(\"a.id < c.id\")\n    .selectExpr(\"a.name as n1\", \"b.name as n2\", \"c.name as n3\")\n    .show()\n    ","user":"admin","dateUpdated":"2019-04-12T02:10:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+---+\n| n1| n2| n3|\n+---+---+---+\n|  D|  E|  F|\n+---+---+---+\n\n"}]},"apps":[],"jobName":"paragraph_1555029316779_-210127458","id":"20190412-003516_1811727394","dateCreated":"2019-04-12T00:35:16+0000","dateStarted":"2019-04-12T02:10:29+0000","dateFinished":"2019-04-12T02:10:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:186","title":"Un esempio di Motiv","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.0.97:4040/jobs/job?id=82","http://172.30.0.97:4040/jobs/job?id=83"],"interpreterSettingId":"spark"}}},{"user":"admin","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555030005000_-1130963202","id":"20190412-004645_2101208049","dateCreated":"2019-04-12T00:46:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:193","text":"spark.sparkContext.setCheckpointDir(\"/tmp\")\r\nval result = g.connectedComponents.run\r\nval num = result.select(\"component\").distinct.count\r\nprintln(s\"Ci sono $num componenti connesse\")\r\n","dateUpdated":"2019-04-12T02:20:01+0000","dateFinished":"2019-04-12T02:19:18+0000","dateStarted":"2019-04-12T02:19:06+0000","title":"Quante componenti connesse?","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Ci sono 2 componenti connesse\nresult: org.apache.spark.sql.DataFrame = [id: int, name: string ... 1 more field]\nnum: Long = 2\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.0.97:4040/jobs/job?id=103","http://172.30.0.97:4040/jobs/job?id=104","http://172.30.0.97:4040/jobs/job?id=105","http://172.30.0.97:4040/jobs/job?id=106","http://172.30.0.97:4040/jobs/job?id=107","http://172.30.0.97:4040/jobs/job?id=108","http://172.30.0.97:4040/jobs/job?id=109","http://172.30.0.97:4040/jobs/job?id=110","http://172.30.0.97:4040/jobs/job?id=111","http://172.30.0.97:4040/jobs/job?id=112","http://172.30.0.97:4040/jobs/job?id=113","http://172.30.0.97:4040/jobs/job?id=114"],"interpreterSettingId":"spark"}}},{"user":"admin","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555035250870_-1106036650","id":"20190412-021410_227599352","dateCreated":"2019-04-12T02:14:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11607","text":"g.bfs.fromExpr(\"name = 'B'\").toExpr(\"name == 'E'\").run().show()\n","dateUpdated":"2019-04-12T02:22:23+0000","dateFinished":"2019-04-12T02:21:24+0000","dateStarted":"2019-04-12T02:21:21+0000","title":"La strada per andare da B ad E","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+----------+-----+----------+-----+----------+-----+\n| from|        e0|   v1|        e1|   v2|        e2|   to|\n+-----+----------+-----+----------+-----+----------+-----+\n|[1,B]|[1,2,10.0]|[2,C]|[2,3,10.0]|[3,D]|[3,4,10.0]|[4,E]|\n+-----+----------+-----+----------+-----+----------+-----+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.0.97:4040/jobs/job?id=115","http://172.30.0.97:4040/jobs/job?id=116","http://172.30.0.97:4040/jobs/job?id=117","http://172.30.0.97:4040/jobs/job?id=118","http://172.30.0.97:4040/jobs/job?id=119","http://172.30.0.97:4040/jobs/job?id=120","http://172.30.0.97:4040/jobs/job?id=121","http://172.30.0.97:4040/jobs/job?id=122","http://172.30.0.97:4040/jobs/job?id=123","http://172.30.0.97:4040/jobs/job?id=124","http://172.30.0.97:4040/jobs/job?id=125","http://172.30.0.97:4040/jobs/job?id=126","http://172.30.0.97:4040/jobs/job?id=127","http://172.30.0.97:4040/jobs/job?id=128","http://172.30.0.97:4040/jobs/job?id=129","http://172.30.0.97:4040/jobs/job?id=130","http://172.30.0.97:4040/jobs/job?id=131","http://172.30.0.97:4040/jobs/job?id=132","http://172.30.0.97:4040/jobs/job?id=133","http://172.30.0.97:4040/jobs/job?id=134","http://172.30.0.97:4040/jobs/job?id=135","http://172.30.0.97:4040/jobs/job?id=136","http://172.30.0.97:4040/jobs/job?id=137","http://172.30.0.97:4040/jobs/job?id=138","http://172.30.0.97:4040/jobs/job?id=139","http://172.30.0.97:4040/jobs/job?id=140","http://172.30.0.97:4040/jobs/job?id=141"],"interpreterSettingId":"spark"}}},{"user":"admin","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555035459749_-1372232027","id":"20190412-021739_813851169","dateCreated":"2019-04-12T02:17:39+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11830"}],"name":"Spark/Lab7/1.Es","id":"2E8GHNAAN","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}