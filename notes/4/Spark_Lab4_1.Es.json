{"paragraphs":[{"text":"%md\n# Esercizio 1 #\nLeggere il file di testo *divina_commedia.txt* e trovare le 10 parole lunghe (più di 5 lettere) più usate. ","user":"bigdata","dateUpdated":"2019-04-10T20:43:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Esercizio 1</h1>\n<p>Leggere il file di testo <em>divina_commedia.txt</em> e trovare le 10 parole lunghe (più di 5 lettere) più usate.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1554926533207_-371681811","id":"20190410-200213_2073530029","dateCreated":"2019-04-10T20:02:13+0000","dateStarted":"2019-04-10T20:43:42+0000","dateFinished":"2019-04-10T20:43:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:588"},{"text":"// leggo\nval df = spark.read.text(\"spark/divina_commedia.txt\").toDF(\"line\").filter(\"line != ''\")\ndf.show(9, false)\n","user":"bigdata","dateUpdated":"2019-04-10T20:43:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------------------------------+\n|line                                      |\n+------------------------------------------+\n|Nel mezzo del cammin di nostra vita       |\n|  mi ritrovai per una selva oscura        |\n|  che' la diritta via era smarrita.       |\n|Ahi quanto a dir qual era e` cosa dura    |\n|  esta selva selvaggia e aspra e forte    |\n|  che nel pensier rinova la paura!        |\n|Tant'e` amara che poco e` piu` morte;     |\n|  ma per trattar del ben ch'i' vi trovai, |\n|  diro` de l'altre cose ch'i' v'ho scorte.|\n+------------------------------------------+\nonly showing top 9 rows\n\ndf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [line: string]\n"}]},"apps":[],"jobName":"paragraph_1554926575185_-1385235182","id":"20190410-200255_196969856","dateCreated":"2019-04-10T20:02:55+0000","dateStarted":"2019-04-10T20:43:45+0000","dateFinished":"2019-04-10T20:44:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:589","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.0.97:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}}},{"text":"// converto in spazi tutte le sequenze di caratteri non alfabetici\n// converto tutto in minuscolo\nval lines = df.select(regexp_replace(lower($\"line\"), \"[^a-z]+\", \" \") as \"line\")\nlines.show(3, false)","user":"bigdata","dateUpdated":"2019-04-10T20:49:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------------------------+\n|line                               |\n+-----------------------------------+\n|nel mezzo del cammin di nostra vita|\n| mi ritrovai per una selva oscura  |\n| che la diritta via era smarrita   |\n+-----------------------------------+\nonly showing top 3 rows\n\nlines: org.apache.spark.sql.DataFrame = [line: string]\n"}]},"apps":[],"jobName":"paragraph_1554926594793_-2117233571","id":"20190410-200314_1123136129","dateCreated":"2019-04-10T20:03:14+0000","dateStarted":"2019-04-10T20:49:39+0000","dateFinished":"2019-04-10T20:49:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:590","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.0.97:4040/jobs/job?id=11"],"interpreterSettingId":"spark"}}},{"text":"// estraggo le singole parole (con ripetizioni)\nval words = lines.select(explode(split($\"line\", \" \")) as \"word\").filter(\"word != ''\")\nwords.take(40)","user":"bigdata","dateUpdated":"2019-04-10T20:49:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554927020339_-1193131954","id":"20190410-201020_747882382","dateCreated":"2019-04-10T20:10:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:591","dateFinished":"2019-04-10T20:49:40+0000","dateStarted":"2019-04-10T20:49:40+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"words: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [word: string]\nres13: Array[org.apache.spark.sql.Row] = Array([nel], [mezzo], [del], [cammin], [di], [nostra], [vita], [mi], [ritrovai], [per], [una], [selva], [oscura], [che], [la], [diritta], [via], [era], [smarrita], [ahi], [quanto], [a], [dir], [qual], [era], [e], [cosa], [dura], [esta], [selva], [selvaggia], [e], [aspra], [e], [forte], [che], [nel], [pensier], [rinova], [la])\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.0.97:4040/jobs/job?id=12"],"interpreterSettingId":"spark"}}},{"user":"bigdata","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554929059335_-1077946932","id":"20190410-204419_1370328732","dateCreated":"2019-04-10T20:44:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1036","text":"// filtro le parole lunghe; raggruppo e conto il numero di occorrenze per ogni parola\nwords\n    .filter(length($\"word\") > 10 )\n    .groupBy(\"word\").count()\n    .orderBy(desc(\"count\"))\n    .show()","dateUpdated":"2019-04-10T20:54:47+0000","dateFinished":"2019-04-10T20:53:35+0000","dateStarted":"2019-04-10T20:53:22+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----+\n|         word|count|\n+-------------+-----+\n|  maravigliar|   10|\n|  incominciai|    8|\n|  riguardando|    8|\n|  subitamente|    7|\n|etternalmente|    6|\n|  similemente|    5|\n|  liberamente|    4|\n|  barbariccia|    4|\n|  fiammeggiar|    4|\n| diversamente|    4|\n|  sicuramente|    4|\n|  malebranche|    4|\n|  simigliante|    4|\n| misericordia|    4|\n| intelligenza|    4|\n|  discendemmo|    3|\n|  somigliante|    3|\n|  piccioletta|    3|\n|  altrettanto|    3|\n|circunferenza|    3|\n+-------------+-----+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.0.97:4040/jobs/job?id=14"],"interpreterSettingId":"spark"}}},{"user":"bigdata","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554929491391_-1572282998","id":"20190410-205131_1856701121","dateCreated":"2019-04-10T20:51:31+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1648"}],"name":"Spark/Lab4/1.Es","id":"2E8NQQSJN","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}